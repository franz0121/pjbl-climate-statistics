import{j as e,r as te}from"./vendor_react-DCpd0Dq0.js";import{b as ae}from"./page-LandingPage.tsx-index-BSx3ZgHx.js";import{aJ as ie,aK as le,aL as ce,aM as de,ay as I}from"./page-portals-StudentPortal-SwtZGgBI.js";const se=({data:H,type:G,colors:U})=>G==="donut"?e.jsxs("div",{className:"donut-chart",children:[e.jsx("div",{className:"chart-container",children:e.jsx("div",{className:"donut-visual",children:H.map((C,z)=>{const S=U||["#0066cc","#00cc99","#ffb84d","#ff6b6b"];return e.jsx("div",{className:"donut-segment",style:{backgroundColor:S[z],width:"60px",height:"60px",borderRadius:"50%",opacity:C.value/100}},z)})})}),e.jsx("div",{className:"legend",children:H.map((C,z)=>{const S=U||["#0066cc","#00cc99","#ffb84d","#ff6b6b"];return e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"color-box",style:{backgroundColor:S[z]}}),e.jsxs("span",{children:[C.label,": ",C.value,"%"]})]},z)})})]}):e.jsx("div",{className:"bar-chart",children:H.map((C,z)=>{const S=U||["#0066cc","#00cc99","#ffb84d","#ff6b6b"];return e.jsxs("div",{className:"bar-item",children:[e.jsx("div",{className:"bar-label",children:C.label}),e.jsx("div",{className:"bar-container",children:e.jsx("div",{className:"bar-fill",style:{width:`${C.value}%`,backgroundColor:S[z]}})}),e.jsxs("div",{className:"bar-value",children:[C.value,"%"]})]},z)})}),ue=({user:H,onLogout:G,classes:U})=>{const[C,z]=te.useState("pre-assessment"),[S,ne]=te.useState("ALL"),V=[{id:"pre-assessment",label:"Pre-Assessment Results",icon:"ðŸ“‹"},{id:"initial-survey",label:"Initial Survey Results",icon:"ðŸ“"},{id:"post-assessment",label:"Post-Assessment Results",icon:"âœ…"},{id:"end-survey",label:"End-of-Lesson Survey",icon:"ðŸ“‹"}],re=["ALL",...U.map(f=>`Section ${f.section}`)],L=S==="ALL"?U.flatMap(f=>f.students):U.filter(f=>`Section ${f.section}`===S).flatMap(f=>f.students),D=L.map(f=>f.username).filter(Boolean),R=ie(D),W=le(D),N=ce(D),O=de(D),ee=f=>{if(f==="csv"){if(C==="pre-assessment"){const g=I(),x=[];x.push(["Name","Username",...Array.from({length:15},(a,t)=>`Q${t+1}`),"Score"]);const n=a=>{const t=(a||"").trim().split(/\s+/);if(t.length<=1)return a;const h=t[t.length-1],i=t.slice(0,t.length-1).join(" ");return`${h}, ${i}`};L.forEach(a=>{const t=g[a.username]||{},h=Array.isArray(t.prePart1Responses)&&t.prePart1Responses.length===15?t.prePart1Responses:null,i=typeof t.prePart1Correct=="number"?t.prePart1Correct:null;h&&x.push([n(a.name||""),a.username||"",...h.map(b=>String(b)),i!=null?String(i):""])});const r=x.map(a=>a.map(t=>`"${String(t).replace(/"/g,'""')}"`).join(",")).join(`
`),u=new Blob([r],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(u),l=document.createElement("a");l.href=p;const y=S==="ALL"?"all":S.replace(/\s+/g,"_").toLowerCase();l.download=`pre_assessment_responses_${y}.csv`,l.click(),URL.revokeObjectURL(p)}else if(C==="initial-survey"){const g=W.responses||[],x=m=>m.length?m.reduce((s,c)=>s+c,0)/m.length:0,n=Array.from({length:17},(m,s)=>x(g.map(c=>c[s]).filter(c=>typeof c=="number"))),r=n.slice(0,5),u=n.slice(5,13),p=n.slice(13,17),l=[],y=m=>m>=3.26?"Very High":m>=2.51?"High":m>=1.76?"Low":"Very Low";l.push(["Indicator","Statement","Mean","Description"]),r.forEach((m,s)=>l.push(["Indicator 1",`Statement ${s+1}`,m.toFixed(2),y(m)])),u.forEach((m,s)=>l.push(["Indicator 2",`Statement ${s+6}`,m.toFixed(2),y(m)])),p.forEach((m,s)=>l.push(["Indicator 3",`Statement ${s+14}`,m.toFixed(2),y(m)])),l.push([]),l.push(["Name","Username",...Array.from({length:17},(m,s)=>`Q${s+1}`)]);const a=I(),t=m=>{const s=(m||"").trim().split(/\s+/);if(s.length<=1)return m;const c=s[s.length-1],j=s.slice(0,s.length-1).join(" ");return`${c}, ${j}`};L.forEach(m=>{const s=a[m.username]||{},c=Array.isArray(s.prePart2Responses)&&s.prePart2Responses.length===17?s.prePart2Responses:null;c&&l.push([t(m.name||""),m.username||"",...c.map(j=>String(j))])});const h=l.map(m=>m.map(s=>`"${String(s).replace(/"/g,'""')}"`).join(",")).join(`
`),i=new Blob([h],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(i),v=document.createElement("a");v.href=b;const P=S==="ALL"?"all":S.replace(/\s+/g,"_").toLowerCase();v.download=`initial_survey_full_${P}.csv`,v.click(),URL.revokeObjectURL(b)}else if(C==="post-assessment"){const g=I(),x=[];x.push(["Name","Username",...Array.from({length:15},(a,t)=>`Q${t+1}`),"Score"]);const n=a=>{const t=(a||"").trim().split(/\s+/);if(t.length<=1)return a;const h=t[t.length-1],i=t.slice(0,t.length-1).join(" ");return`${h}, ${i}`};L.forEach(a=>{const t=g[a.username]||{},h=Array.isArray(t.postPart1Responses)&&t.postPart1Responses.length===15?t.postPart1Responses:null,i=typeof t.postPart1Correct=="number"?t.postPart1Correct:null;h&&x.push([n(a.name||""),a.username||"",...h.map(b=>String(b)),i!=null?String(i):""])});const r=x.map(a=>a.map(t=>`"${String(t).replace(/"/g,'""')}"`).join(",")).join(`
`),u=new Blob([r],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(u),l=document.createElement("a");l.href=p;const y=S==="ALL"?"all":S.replace(/\s+/g,"_").toLowerCase();l.download=`post_assessment_responses_${y}.csv`,l.click(),URL.revokeObjectURL(p)}else if(C==="end-survey"){const g=O.responses||[],x=m=>m.length?m.reduce((s,c)=>s+c,0)/m.length:0,n=Array.from({length:17},(m,s)=>x(g.map(c=>c[s]).filter(c=>typeof c=="number"))),r=n.slice(0,5),u=n.slice(5,13),p=n.slice(13,17),l=m=>m>=3.26?"Very High":m>=2.51?"High":m>=1.76?"Low":"Very Low",y=[];y.push(["Indicator","Statement","Mean","Description"]),r.forEach((m,s)=>y.push(["Indicator 1",`Statement ${s+1}`,m.toFixed(2),l(m)])),u.forEach((m,s)=>y.push(["Indicator 2",`Statement ${s+6}`,m.toFixed(2),l(m)])),p.forEach((m,s)=>y.push(["Indicator 3",`Statement ${s+14}`,m.toFixed(2),l(m)])),y.push([]),y.push(["Name","Username",...Array.from({length:17},(m,s)=>`Q${s+1}`)]);const a=I(),t=m=>{const s=(m||"").trim().split(/\s+/);if(s.length<=1)return m;const c=s[s.length-1],j=s.slice(0,s.length-1).join(" ");return`${c}, ${j}`};L.forEach(m=>{const s=a[m.username]||{},c=Array.isArray(s.postPart2Responses)&&s.postPart2Responses.length===17?s.postPart2Responses:null;c&&y.push([t(m.name||""),m.username||"",...c.map(j=>String(j))])});const h=y.map(m=>m.map(s=>`"${String(s).replace(/"/g,'""')}"`).join(",")).join(`
`),i=new Blob([h],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(i),v=document.createElement("a");v.href=b;const P=S==="ALL"?"all":S.replace(/\s+/g,"_").toLowerCase();v.download=`end_lesson_survey_full_${P}.csv`,v.click(),URL.revokeObjectURL(b)}}else{if(C==="pre-assessment"){const n=I(),r="Pre-Assessment Results",u=o=>{const d=(o||"").trim().split(/\s+/);if(d.length<=1)return o;const A=d[d.length-1],$=d.slice(0,d.length-1).join(" ");return`${A}, ${$}`},p=R.scores.filter(o=>o>=14).length,l=R.scores.filter(o=>o>=11&&o<=13).length,y=R.scores.filter(o=>o>=9&&o<=10).length,a=R.scores.filter(o=>o<=8).length,t=R.scores.length||1,i=Array.from({length:15},(o,d)=>d+1).map(o=>R.scores.filter(d=>d===o).length);Math.max(1,...i);const b=I(),v=Array.from({length:15},()=>({A:0,B:0,C:0,D:0}));L.forEach(o=>{const d=b[o.username]||{},A=Array.isArray(d.prePart1Responses)&&d.prePart1Responses.length===15?d.prePart1Responses:null;A&&A.forEach(($,F)=>{const w=($||"").toUpperCase();(w==="A"||w==="B"||w==="C"||w==="D")&&(v[F][w]=(v[F][w]||0)+1)})});const P=v.map(o=>o.A+o.B+o.C+o.D),m=Math.max(1,...P),s=["C","A","C","D","A","B","A","B","A","C","B","A","C","D","A"],c={A:"#FFF6C2",B:"#FFDDE6",C:"#E9D9FF",D:"#DFFFE1"},j="#7FA8FF",E=R.groups||[],K=E.map(o=>o.lc12),X=E.map(o=>o.lc34),Y=E.map(o=>o.lc56),T=o=>{if(!o||o.length===0)return{min:0,q1:0,med:0,q3:0,max:0};const d=[...o].sort(($,F)=>$-F),A=$=>{const F=(d.length-1)*$,w=Math.floor(F),_=Math.ceil(F);return _===w?d[w]:d[w]+(d[_]-d[w])*(F-w)};return{min:d[0],q1:A(.25),med:A(.5),q3:A(.75),max:d[d.length-1]}},k=T(K),M=T(X),B=T(Y),Q=L.map(o=>{const d=n[o.username]||{},A=Array.isArray(d.prePart1Responses)&&d.prePart1Responses.length===15?d.prePart1Responses:null,$=typeof d.prePart1Correct=="number"?d.prePart1Correct:null;return{name:o.name||"",username:o.username||"",answers:A,score:$}}).filter(o=>o.answers!==null);Q.sort((o,d)=>u(o.name).toLowerCase().localeCompare(u(d.name).toLowerCase()));const J=`
          <html>
            <head>
              <title>${r}</title>
              <style>
                body{font-family:Arial,Helvetica,sans-serif;color:#1f2937;padding:18px}
                h1{font-size:20px;margin-bottom:6px}
                .cards{display:flex;gap:12px;margin:8px 0 18px}
                .card{border:1px solid #e5e7eb;padding:10px;border-radius:6px;background:#fff}
                .card h4{margin:0 0 6px;font-size:12px;color:#374151}
                .card p{margin:0;font-size:18px;font-weight:700}
                .levels, .histogram, .boxplots, .responses{margin-top:12px}
                .hist-row{display:flex;align-items:flex-end;gap:6px;height:120px}
                .hist-bar{width:26px;text-align:center}
                .hist-fill{background:#6C8AE4;border-radius:4px 4px 0 0;margin-bottom:4px}
                table{border-collapse:collapse;width:100%;font-size:12px}
                th,td{border:1px solid #e5e7eb;padding:6px}
                th{background:#f8fafc}
                .small{font-size:12px;color:#374151}
              </style>
            </head>
            <body>
              <h1>${r}</h1>
              <div class="small">Filter: ${S} â€” Generated from Admin Dashboard</div>
              <div class="cards">
                <div class="card"><h4>Students Enrolled</h4><p>${D.length}</p></div>
                <div class="card"><h4>Actual Takers</h4><p>${R.tested}</p></div>
                <div class="card"><h4>Completion Rate</h4><p>${D.length?Math.round(R.tested/D.length*100):0}%</p></div>
              </div>

              <div class="levels">
                <h3>Students' Level of Achievement in Statistical Literacy and Critical Thinking</h3>
                <table><thead><tr><th>Level</th><th>Count</th><th>Percent</th></tr></thead><tbody>
                  <tr><td>Beginning</td><td>${a}</td><td>${Math.round(a/t*100)}%</td></tr>
                  <tr><td>Developing</td><td>${y}</td><td>${Math.round(y/t*100)}%</td></tr>
                  <tr><td>Proficient</td><td>${l}</td><td>${Math.round(l/t*100)}%</td></tr>
                  <tr><td>Advanced</td><td>${p}</td><td>${Math.round(p/t*100)}%</td></tr>
                </tbody></table>
              </div>

              <div class="histogram">
                <h3>Frequency of Responses</h3>
                ${v.map((o,d)=>{const A=["A","B","C","D"].map($=>{const F=o[$]||0,w=F/m*100,_=s[d]===$,Z=_?j:c[$];return`<div style="width:${w}%;background:${Z};display:flex;align-items:center;justify-content:center;font-size:12px;color:${_?"#fff":"#111"}">${F}</div>`}).join("");return`<div style="display:flex;align-items:center;gap:8;margin-bottom:6px;"><div style="width:40px;text-align:right;font-size:12px">Q${d+1}</div><div style="flex:1 1 auto;display:flex;height:28px;border:1px solid #eef2ff;border-radius:4px;overflow:hidden">${A}</div></div>`}).join("")}
              </div>

              <div class="boxplots">
                <h3>Boxplots by Learning Competency (summary stats)</h3>
                <table><thead><tr><th>Competency</th><th>Min</th><th>Q1</th><th>Median</th><th>Q3</th><th>Max</th></tr></thead>
                <tbody>
                  <tr><td>LC1-2 (Items 1â€“5)</td><td>${k.min}</td><td>${k.q1.toFixed(2)}</td><td>${k.med.toFixed(2)}</td><td>${k.q3.toFixed(2)}</td><td>${k.max}</td></tr>
                  <tr><td>LC3-4 (Items 6â€“10)</td><td>${M.min}</td><td>${M.q1.toFixed(2)}</td><td>${M.med.toFixed(2)}</td><td>${M.q3.toFixed(2)}</td><td>${M.max}</td></tr>
                  <tr><td>LC5-6 (Items 11â€“15)</td><td>${B.min}</td><td>${B.q1.toFixed(2)}</td><td>${B.med.toFixed(2)}</td><td>${B.q3.toFixed(2)}</td><td>${B.max}</td></tr>
                </tbody></table>
              </div>

              <div class="responses">
                <h3>List of Students and their Responses (Pre Part I)</h3>
                <div style="overflow-x:auto">
                  <table>
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Username</th>
                        ${Array.from({length:15},(o,d)=>`<th>Q${d+1}</th>`).join("")}
                        <th>Score</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${Q.map(o=>`<tr><td style="white-space:nowrap;text-align:left">${u(o.name)}</td><td>${o.username}</td>${(o.answers||[]).map(d=>`<td>${String(d)}</td>`).join("")}<td style="text-align:center">${o.score}</td></tr>`).join("")}
                    </tbody>
                  </table>
                </div>
              </div>
            </body>
          </html>
        `,q=window.open("","_blank");if(!q)return;q.document.write(J),q.document.close(),q.focus(),setTimeout(()=>{try{q.print()}catch{}},400);return}if(C==="post-assessment"){const n=I(),r="Post-Assessment Results",u=o=>{const d=(o||"").trim().split(/\s+/);if(d.length<=1)return o;const A=d[d.length-1],$=d.slice(0,d.length-1).join(" ");return`${A}, ${$}`},p=N.scores.filter(o=>o>=14).length,l=N.scores.filter(o=>o>=11&&o<=13).length,y=N.scores.filter(o=>o>=9&&o<=10).length,a=N.scores.filter(o=>o<=8).length,t=N.scores.length||1,i=Array.from({length:15},(o,d)=>d+1).map(o=>N.scores.filter(d=>d===o).length);Math.max(1,...i);const b=I(),v=Array.from({length:15},()=>({A:0,B:0,C:0,D:0}));L.forEach(o=>{const d=b[o.username]||{},A=Array.isArray(d.postPart1Responses)&&d.postPart1Responses.length===15?d.postPart1Responses:null;A&&A.forEach(($,F)=>{const w=($||"").toUpperCase();(w==="A"||w==="B"||w==="C"||w==="D")&&(v[F][w]=(v[F][w]||0)+1)})});const P=v.map(o=>o.A+o.B+o.C+o.D),m=Math.max(1,...P),s=["C","A","C","D","A","B","A","B","A","C","B","A","C","D","A"],c={A:"#FFF6C2",B:"#FFDDE6",C:"#E9D9FF",D:"#DFFFE1"},j="#7FA8FF",E=N.groups||[],K=E.map(o=>o.lc12),X=E.map(o=>o.lc34),Y=E.map(o=>o.lc56),T=o=>{if(!o||o.length===0)return{min:0,q1:0,med:0,q3:0,max:0};const d=[...o].sort(($,F)=>$-F),A=$=>{const F=(d.length-1)*$,w=Math.floor(F),_=Math.ceil(F);return _===w?d[w]:d[w]+(d[_]-d[w])*(F-w)};return{min:d[0],q1:A(.25),med:A(.5),q3:A(.75),max:d[d.length-1]}},k=T(K),M=T(X),B=T(Y),Q=L.map(o=>{const d=n[o.username]||{},A=Array.isArray(d.postPart1Responses)&&d.postPart1Responses.length===15?d.postPart1Responses:null,$=typeof d.postPart1Correct=="number"?d.postPart1Correct:null;return{name:o.name||"",username:o.username||"",answers:A,score:$}}).filter(o=>o.answers!==null);Q.sort((o,d)=>u(o.name).toLowerCase().localeCompare(u(d.name).toLowerCase()));const J=`
          <html>
            <head>
              <title>${r}</title>
              <style>
                body{font-family:Arial,Helvetica,sans-serif;color:#1f2937;padding:18px}
                h1{font-size:20px;margin-bottom:6px}
                .cards{display:flex;gap:12px;margin:8px 0 18px}
                .card{border:1px solid #e5e7eb;padding:10px;border-radius:6px;background:#fff}
                .card h4{margin:0 0 6px;font-size:12px;color:#374151}
                .card p{margin:0;font-size:18px;font-weight:700}
                .levels, .histogram, .boxplots, .responses{margin-top:12px}
                .hist-row{display:flex;align-items:flex-end;gap:6px;height:120px}
                .hist-bar{width:26px;text-align:center}
                .hist-fill{background:#6C8AE4;border-radius:4px 4px 0 0;margin-bottom:4px}
                table{border-collapse:collapse;width:100%;font-size:12px}
                th,td{border:1px solid #e5e7eb;padding:6px}
                th{background:#f8fafc}
                .small{font-size:12px;color:#374151}
              </style>
            </head>
            <body>
              <h1>${r}</h1>
              <div class="small">Filter: ${S} â€” Generated from Admin Dashboard</div>
              <div class="cards">
                <div class="card"><h4>Students Enrolled</h4><p>${D.length}</p></div>
                <div class="card"><h4>Actual Takers</h4><p>${N.tested}</p></div>
                <div class="card"><h4>Completion Rate</h4><p>${D.length?Math.round(N.tested/D.length*100):0}%</p></div>
              </div>

              <div class="levels">
                <h3>Students' Level of Achievement in Statistical Literacy and Critical Thinking (Post)</h3>
                <table><thead><tr><th>Level</th><th>Count</th><th>Percent</th></tr></thead><tbody>
                  <tr><td>Beginning</td><td>${a}</td><td>${Math.round(a/t*100)}%</td></tr>
                  <tr><td>Developing</td><td>${y}</td><td>${Math.round(y/t*100)}%</td></tr>
                  <tr><td>Proficient</td><td>${l}</td><td>${Math.round(l/t*100)}%</td></tr>
                  <tr><td>Advanced</td><td>${p}</td><td>${Math.round(p/t*100)}%</td></tr>
                </tbody></table>
              </div>

              <div class="histogram">
                <h3>Frequency of Responses</h3>
                ${v.map((o,d)=>{const A=["A","B","C","D"].map($=>{const F=o[$]||0,w=F/m*100,_=s[d]===$,Z=_?j:c[$];return`<div style="width:${w}%;background:${Z};display:flex;align-items:center;justify-content:center;font-size:12px;color:${_?"#fff":"#111"}">${F}</div>`}).join("");return`<div style="display:flex;align-items:center;gap:8;margin-bottom:6px;"><div style="width:40px;text-align:right;font-size:12px">Q${d+1}</div><div style="flex:1 1 auto;display:flex;height:28px;border:1px solid #eef2ff;border-radius:4px;overflow:hidden">${A}</div></div>`}).join("")}
              </div>

              <div class="boxplots">
                <h3>Boxplots by Learning Competency (summary stats)</h3>
                <table><thead><tr><th>Competency</th><th>Min</th><th>Q1</th><th>Median</th><th>Q3</th><th>Max</th></tr></thead>
                <tbody>
                  <tr><td>LC1-2 (Items 1â€“5)</td><td>${k.min}</td><td>${k.q1.toFixed(2)}</td><td>${k.med.toFixed(2)}</td><td>${k.q3.toFixed(2)}</td><td>${k.max}</td></tr>
                  <tr><td>LC3-4 (Items 6â€“10)</td><td>${M.min}</td><td>${M.q1.toFixed(2)}</td><td>${M.med.toFixed(2)}</td><td>${M.q3.toFixed(2)}</td><td>${M.max}</td></tr>
                  <tr><td>LC5-6 (Items 11â€“15)</td><td>${B.min}</td><td>${B.q1.toFixed(2)}</td><td>${B.med.toFixed(2)}</td><td>${B.q3.toFixed(2)}</td><td>${B.max}</td></tr>
                </tbody></table>
              </div>

              <div class="responses">
                <h3>List of Students and their Responses (Post Part I)</h3>
                <div style="overflow-x:auto">
                  <table>
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Username</th>
                        ${Array.from({length:15},(o,d)=>`<th>Q${d+1}</th>`).join("")}
                        <th>Score</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${Q.map(o=>`<tr><td style="white-space:nowrap;text-align:left">${u(o.name)}</td><td>${o.username}</td>${(o.answers||[]).map(d=>`<td>${String(d)}</td>`).join("")}<td style="text-align:center">${o.score}</td></tr>`).join("")}
                    </tbody>
                  </table>
                </div>
              </div>
            </body>
          </html>
        `,q=window.open("","_blank");if(!q)return;q.document.write(J),q.document.close(),q.focus(),setTimeout(()=>{try{q.print()}catch{}},400);return}if(C==="initial-survey"){const n="Initial Survey Results",r=W.responses||[],u=s=>s.length?s.reduce((c,j)=>c+j,0)/s.length:0,p=Array.from({length:17},(s,c)=>u(r.map(j=>j[c]).filter(j=>typeof j=="number"))),l=p.slice(0,5),y=p.slice(5,13),a=p.slice(13,17),t=["Climate change increases disease rates in my community.","Higher temperatures correlate with lower crop yields significantly.","Diarrhea cases rise when rainfall patterns change drastically.","Cholera becomes more toxic in warmer water temperatures.","Floods spread waterborne diseases faster than before now.","Public transportation reduces my personal carbon emissions significantly.","Eating natural foods lowers my environmental impact considerably.","GHG-free refrigerators decrease household emissions over time effectively.","Eco-friendly air conditioners use less energy than standard models.","Emission-free cars correlate with better local air quality.","Reducing trips decreases car fuel consumption and emissions.","Carpooling with others cuts per-person emissions by half.","Correct tire pressure improves fuel efficiency by percentages.","Proper building insulation reduces energy use significantly overall.","Solar energy adoption correlates with lower production costs.","Reusing waste heat decreases total energy consumption substantially.","Bio-gas use reduces industrial fossil fuel dependence considerably."],h=s=>{const c=(s||"").trim().split(/\s+/);if(c.length<=1)return s;const j=c[c.length-1],E=c.slice(0,c.length-1).join(" ");return`${j}, ${E}`},i=I(),b=L.map(s=>{const c=i[s.username]||{},j=Array.isArray(c.prePart2Responses)&&c.prePart2Responses.length===17?c.prePart2Responses:null;return{name:s.name||"",username:s.username||"",responses:j}}).filter(s=>s.responses!==null);b.sort((s,c)=>h(s.name).toLowerCase().localeCompare(h(c.name).toLowerCase()));const v=s=>s>=3.26?"Very High":s>=2.51?"High":s>=1.76?"Low":"Very Low",P=`
          <html>
            <head>
              <title>${n}</title>
              <style>
                body{font-family:Arial,Helvetica,sans-serif;color:#1f2937;padding:18px}
                h1{font-size:20px;margin-bottom:6px}
                table{border-collapse:collapse;width:100%;font-size:12px;margin-top:12px}
                th,td{border:1px solid #e5e7eb;padding:6px}
                th{background:#f8fafc}
                .indicator-list{margin:0;padding-left:16px}
              </style>
            </head>
            <body>
              <h1>${n}</h1>
              <div class="small">Filter: ${S} â€” Generated from Admin Dashboard</div>
              <h3>Indicators and Statements</h3>
              <table>
                <thead><tr><th>Indicator</th><th>Statement</th><th>Mean</th><th>Description</th></tr></thead>
                <tbody>
                  ${l.map((s,c)=>`<tr><td>Indicator 1</td><td>${t[c]}</td><td>${s.toFixed(2)}</td><td>${v(s)}</td></tr>`).join("")}
                  ${y.map((s,c)=>`<tr><td>Indicator 2</td><td>${t[c+5]}</td><td>${s.toFixed(2)}</td><td>${v(s)}</td></tr>`).join("")}
                  ${a.map((s,c)=>`<tr><td>Indicator 3</td><td>${t[c+13]}</td><td>${s.toFixed(2)}</td><td>${v(s)}</td></tr>`).join("")}
                </tbody>
              </table>

              <h3>List of Students and their Survey Responses</h3>
              <div style="overflow-x:auto">
                <table>
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Username</th>
                      ${Array.from({length:17},(s,c)=>`<th>Q${c+1}</th>`).join("")}
                    </tr>
                  </thead>
                  <tbody>
                    ${b.map(s=>`<tr><td style="white-space:nowrap;text-align:left">${h(s.name)}</td><td>${s.username}</td>${(s.responses||[]).map(c=>`<td>${String(c)}</td>`).join("")}</tr>`).join("")}
                  </tbody>
                </table>
              </div>
            </body>
          </html>
        `,m=window.open("","_blank");if(!m)return;m.document.write(P),m.document.close(),m.focus(),setTimeout(()=>{try{m.print()}catch{}},400);return}if(C==="end-survey"){const n="End-of-Lesson Survey Results",r=O.responses||[],u=s=>s.length?s.reduce((c,j)=>c+j,0)/s.length:0,p=Array.from({length:17},(s,c)=>u(r.map(j=>j[c]).filter(j=>typeof j=="number"))),l=p.slice(0,5),y=p.slice(5,13),a=p.slice(13,17),t=["Climate change increases disease rates in my community.","Higher temperatures correlate with lower crop yields significantly.","Diarrhea cases rise when rainfall patterns change drastically.","Cholera becomes more toxic in warmer water temperatures.","Floods spread waterborne diseases faster than before now.","Public transportation reduces my personal carbon emissions significantly.","Eating natural foods lowers my environmental impact considerably.","GHG-free refrigerators decrease household emissions over time effectively.","Eco-friendly air conditioners use less energy than standard models.","Emission-free cars correlate with better local air quality.","Reducing trips decreases car fuel consumption and emissions.","Carpooling with others cuts per-person emissions by half.","Correct tire pressure improves fuel efficiency by percentages.","Proper building insulation reduces energy use significantly overall.","Solar energy adoption correlates with lower production costs.","Reusing waste heat decreases total energy consumption substantially.","Bio-gas use reduces industrial fossil fuel dependence considerably."],h=s=>{const c=(s||"").trim().split(/\s+/);if(c.length<=1)return s;const j=c[c.length-1],E=c.slice(0,c.length-1).join(" ");return`${j}, ${E}`},i=I(),b=L.map(s=>{const c=i[s.username]||{},j=Array.isArray(c.postPart2Responses)&&c.postPart2Responses.length===17?c.postPart2Responses:null;return{name:s.name||"",username:s.username||"",responses:j}}).filter(s=>s.responses!==null);b.sort((s,c)=>h(s.name).toLowerCase().localeCompare(h(c.name).toLowerCase()));const v=s=>s>=3.26?"Very High":s>=2.51?"High":s>=1.76?"Low":"Very Low",P=`
          <html>
            <head>
              <title>${n}</title>
              <style>
                body{font-family:Arial,Helvetica,sans-serif;color:#1f2937;padding:18px}
                h1{font-size:20px;margin-bottom:6px}
                table{border-collapse:collapse;width:100%;font-size:12px;margin-top:12px}
                th,td{border:1px solid #e5e7eb;padding:6px}
                th{background:#f8fafc}
                .indicator-list{margin:0;padding-left:16px}
              </style>
            </head>
            <body>
              <h1>${n}</h1>
              <div class="small">Filter: ${S} â€” Generated from Admin Dashboard</div>
              <h3>Indicators and Statements</h3>
              <table>
                <thead><tr><th>Indicator</th><th>Statement</th><th>Mean</th><th>Description</th></tr></thead>
                <tbody>
                  ${l.map((s,c)=>`<tr><td>Indicator 1</td><td>${t[c]}</td><td>${s.toFixed(2)}</td><td>${v(s)}</td></tr>`).join("")}
                  ${y.map((s,c)=>`<tr><td>Indicator 2</td><td>${t[c+5]}</td><td>${s.toFixed(2)}</td><td>${v(s)}</td></tr>`).join("")}
                  ${a.map((s,c)=>`<tr><td>Indicator 3</td><td>${t[c+13]}</td><td>${s.toFixed(2)}</td><td>${v(s)}</td></tr>`).join("")}
                </tbody>
              </table>

              <h3>List of Students and their Survey Responses</h3>
              <div style="overflow-x:auto">
                <table>
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Username</th>
                      ${Array.from({length:17},(s,c)=>`<th>Q${c+1}</th>`).join("")}
                    </tr>
                  </thead>
                  <tbody>
                    ${b.map(s=>`<tr><td style="white-space:nowrap;text-align:left">${h(s.name)}</td><td>${s.username}</td>${(s.responses||[]).map(c=>`<td>${String(c)}</td>`).join("")}</tr>`).join("")}
                  </tbody>
                </table>
              </div>
            </body>
          </html>
        `,m=window.open("","_blank");if(!m)return;m.document.write(P),m.document.close(),m.focus(),setTimeout(()=>{try{m.print()}catch{}},400);return}const g=window.open("","_blank");if(!g)return;const x=V.find(n=>n.id===C)?.label||"Report";g.document.write(`<html><head><title>${x}</title></head><body><h1>${x}</h1><p>Filter: ${S}</p><p>Generated from Admin Dashboard.</p></body></html>`),g.document.close(),g.focus(),setTimeout(()=>{try{g.print()}catch{}},300)}};return e.jsxs("div",{className:"portal-container admin-portal",children:[e.jsxs("header",{className:"portal-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("span",{className:"header-badge badge--admin",children:e.jsx(ae,{})}),e.jsxs("div",{className:"header-texts",children:[e.jsx("h1",{className:"portal-title",children:"Statistics Meets Climate Action"}),e.jsx("p",{className:"portal-subtitle",children:"Administrator Dashboard"})]})]}),e.jsxs("div",{className:"header-right",children:[e.jsxs("p",{className:"welcome-text",children:["Welcome, ",e.jsx("strong",{children:H.username})]}),e.jsx("button",{className:"logout-button",onClick:G,children:"Logout"})]})]}),e.jsxs("main",{className:"portal-content",children:[e.jsx("div",{className:"portal-tabs",children:V.map(f=>e.jsxs("button",{className:`tab-button ${C===f.id?"active":""}`,onClick:()=>z(f.id),children:[e.jsx("span",{className:"tab-icon",children:f.icon}),f.label]},f.id))}),e.jsxs("div",{className:"admin-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:V.find(f=>f.id===C)?.label}),e.jsxs("div",{className:"download-buttons",children:[e.jsx("button",{className:"download-btn",onClick:()=>ee("pdf"),children:"ðŸ“¥ Download PDF"}),e.jsx("button",{className:"download-btn",onClick:()=>ee("csv"),children:"ðŸ“¥ Download CSV"})]})]}),e.jsx("div",{className:"admin-filters",children:e.jsxs("label",{children:["Filter:",e.jsx("select",{value:S,onChange:f=>ne(f.target.value),children:re.map(f=>e.jsx("option",{value:f,children:f},f))})]})}),C==="pre-assessment"&&e.jsxs("div",{className:"pre-assessment-layout",children:[e.jsxs("div",{className:"cards-row",children:[e.jsxs("div",{className:"stat-box metric-card card-enrolled",children:[e.jsx("h4",{children:"Students Enrolled"}),e.jsx("p",{className:"stat-number-large",children:D.length})]}),e.jsxs("div",{className:"stat-box metric-card card-takers",children:[e.jsx("h4",{children:"Actual Takers"}),e.jsx("p",{className:"stat-number-large",children:R.tested})]}),e.jsxs("div",{className:"stat-box metric-card donut-card card-completion",children:[e.jsx("h4",{children:"Completion Rate"}),e.jsx("div",{className:"donut-inline",children:(()=>{const f=D.length?Math.round(R.tested/D.length*100):0,g=32,x=2*Math.PI*g,n=f/100*x;return e.jsxs("svg",{viewBox:"0 0 100 100",className:"donut-svg",children:[e.jsx("circle",{cx:"50",cy:"50",r:g,stroke:"#e6eef9",strokeWidth:"14",fill:"none"}),e.jsx("circle",{cx:"50",cy:"50",r:g,stroke:"#6C8AE4",strokeWidth:"14",fill:"none",strokeDasharray:`${n} ${x-n}`,transform:"rotate(-90 50 50)"}),e.jsxs("text",{x:"50",y:"55",textAnchor:"middle",fill:"#3A4A7A",fontSize:"18",fontWeight:700,children:[f,"%"]})]})})()})]})]}),e.jsxs("div",{className:"charts-row one-column",children:[e.jsxs("div",{className:"chart-section wide card-levels",children:[e.jsx("h3",{children:"Students' Level of Achievement in Statistical Literacy and Critical Thinking"}),(()=>{const f=R.scores.filter(l=>l>=14).length,g=R.scores.filter(l=>l>=11&&l<=13).length,x=R.scores.filter(l=>l>=9&&l<=10).length,n=R.scores.filter(l=>l<=8).length,r=R.scores.length||1,u=[{label:`Beginning (${n})`,value:Math.round(n/r*100)},{label:`Developing (${x})`,value:Math.round(x/r*100)},{label:`Proficient (${g})`,value:Math.round(g/r*100)},{label:`Advanced (${f})`,value:Math.round(f/r*100)}],p=["#CBD5E1","#93B5E1","#6FA8DC","#4F6EDC"];return e.jsx(se,{data:u,type:"bar",colors:p})})()]}),e.jsxs("div",{className:"chart-section wide card-histogram",children:[e.jsx("h3",{children:"Frequency of Responses"}),(()=>{const f=I(),g=Array.from({length:15},()=>({A:0,B:0,C:0,D:0}));L.forEach(l=>{const y=f[l.username]||{},a=Array.isArray(y.prePart1Responses)&&y.prePart1Responses.length===15?y.prePart1Responses:null;a&&a.forEach((t,h)=>{const i=(t||"").toUpperCase();(i==="A"||i==="B"||i==="C"||i==="D")&&(g[h][i]=(g[h][i]||0)+1)})});const x=g.map(l=>l.A+l.B+l.C+l.D),n=Math.max(1,...x),r=["C","A","C","D","A","B","A","B","A","C","B","A","C","D","A"],u={A:"#FFF6C2",B:"#FFDDE6",C:"#E9D9FF",D:"#DFFFE1"},p="#7FA8FF";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",paddingLeft:40},children:[e.jsx("div",{style:{fontWeight:700},children:"Legend:"}),["A","B","C","D"].map(l=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:14,height:14,background:u[l],borderRadius:3,border:"1px solid #e6e6e6"}}),e.jsx("div",{style:{fontSize:13},children:l})]},l)),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:14,height:14,background:p,borderRadius:3,border:"1px solid #e6e6e6"}}),e.jsx("div",{style:{fontSize:13},children:"Correct"})]})]}),g.map((l,y)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("div",{style:{width:40,textAlign:"right",fontSize:12},children:["Q",y+1]}),e.jsx("div",{style:{flex:"1 1 auto",display:"flex",height:28,border:"1px solid #eef2ff",borderRadius:4,overflow:"hidden"},children:["A","B","C","D"].map(a=>{const t=l[a]||0,h=t/n*100,i=r[y]===a,b=i?p:u[a];return e.jsx("div",{style:{width:`${h}%`,background:b,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,color:i?"#fff":"#111"},children:t},a)})})]},y))]})})()]}),e.jsxs("div",{className:"chart-section wide card-boxplots",children:[e.jsx("h3",{children:"Boxplots by Learning Competency"}),(()=>{const f=R.groups,g=f.map(a=>a.lc12),x=f.map(a=>a.lc34),n=f.map(a=>a.lc56),r=a=>{if(a.length===0)return{min:0,q1:0,med:0,q3:0,max:0};const t=[...a].sort((i,b)=>i-b),h=i=>{const b=(t.length-1)*i,v=Math.floor(b),P=Math.ceil(b);return P===v?t[v]:t[v]+(t[P]-t[v])*(b-v)};return{min:t[0],q1:h(.25),med:h(.5),q3:h(.75),max:t[t.length-1]}},u=r(g),p=r(x),l=r(n),y=(a,t)=>{const h=i=>i/5*260;return e.jsxs("div",{className:"boxplot",children:[e.jsx("div",{className:"boxplot-label",children:t}),e.jsxs("svg",{viewBox:"0 0 300 60",className:"boxplot-svg",children:[e.jsx("line",{x1:20+h(a.min),y1:30,x2:20+h(a.max),y2:30,stroke:"#9fb7df",strokeWidth:2}),e.jsx("rect",{x:20+h(a.q1),y:18,width:Math.max(2,h(a.q3)-h(a.q1)),height:24,fill:"#f0f6ff",stroke:"#2C4795"}),e.jsx("line",{x1:20+h(a.med),y1:18,x2:20+h(a.med),y2:42,stroke:"#43A047",strokeWidth:2})]})]},t)};return e.jsxs("div",{className:"boxplots",children:[y(u,"LC1-2 (Items 1â€“5)"),y(p,"LC3-4 (Items 6â€“10)"),y(l,"LC5-6 (Items 11â€“15)")]})})()]}),e.jsxs("div",{className:"chart-section table-section card-student-responses",children:[e.jsx("h3",{children:"List of Students and their Responses"}),(()=>{const f=I(),g=L.map(n=>{const r=f[n.username]||{};return{name:n.name||"",username:n.username||"",answers:r.prePart1Responses||Array.from({length:15},()=>""),score:typeof r.prePart1Correct=="number"?r.prePart1Correct:null}}).filter(n=>n.score!==null),x=n=>{const r=(n||"").trim().split(/\s+/);if(r.length<=1)return n;const u=r[r.length-1],p=r.slice(0,r.length-1).join(" ");return`${u}, ${p}`};return g.sort((n,r)=>{const u=x(n.name).toLowerCase(),p=x(r.name).toLowerCase();return u.localeCompare(p)}),e.jsx("div",{children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),Array.from({length:15},(n,r)=>e.jsxs("th",{children:["Q",r+1]},r)),e.jsx("th",{children:"Score"})]})}),e.jsx("tbody",{children:g.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{style:{whiteSpace:"nowrap",textAlign:"left"},children:x(n.name)}),n.answers.map((u,p)=>e.jsx("td",{children:u},p)),e.jsx("td",{style:{textAlign:"center"},children:n.score})]},n.username||r))})]})})})})()]})]})]}),C==="initial-survey"&&e.jsxs("div",{className:"initial-survey-layout",children:[(()=>{const f=W.responses,g=t=>t.length?t.reduce((h,i)=>h+i,0)/t.length:0,x=Array.from({length:17},(t,h)=>g(f.map(i=>i[h]).filter(i=>typeof i=="number"))),n=x.slice(0,5),r=x.slice(5,13),u=x.slice(13,17),p=t=>t.length?t.reduce((h,i)=>h+i,0)/t.length:0,l=t=>t>=3.26?"Very High":t>=2.51?"High":t>=1.76?"Low":"Very Low",y=["Climate change increases disease rates in my community.","Higher temperatures correlate with lower crop yields significantly.","Diarrhea cases rise when rainfall patterns change drastically.","Cholera becomes more toxic in warmer water temperatures.","Floods spread waterborne diseases faster than before now.","Public transportation reduces my personal carbon emissions significantly.","Eating natural foods lowers my environmental impact considerably.","GHG-free refrigerators decrease household emissions over time effectively.","Eco-friendly air conditioners use less energy than standard models.","Emission-free cars correlate with better local air quality.","Reducing trips decreases car fuel consumption and emissions.","Carpooling with others cuts per-person emissions by half.","Correct tire pressure improves fuel efficiency by percentages.","Proper building insulation reduces energy use significantly overall.","Solar energy adoption correlates with lower production costs.","Reusing waste heat decreases total energy consumption substantially.","Bio-gas use reduces industrial fossil fuel dependence considerably."],a=[{indicator:"Awareness of Effects or Impacts of Climate Change",itemIdx:[0,1,2,3,4],means:n,overall:p(n)},{indicator:"Awareness Individual Initiative to Address Climate Change",itemIdx:[5,6,7,8,9,10,11,12],means:r,overall:p(r)},{indicator:"Awareness of Industry Initiative to Address Climate Change",itemIdx:[13,14,15,16],means:u,overall:p(u)}];return e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left"},children:"Indicator & Statements"}),e.jsx("th",{style:{textAlign:"center"},children:"Scores"}),e.jsx("th",{style:{textAlign:"center"},children:"Description"})]})}),e.jsx("tbody",{children:a.map((t,h)=>e.jsxs("tr",{children:[e.jsxs("td",{style:{textAlign:"left"},children:[e.jsx("div",{className:"indicator-title",children:t.indicator}),e.jsx("ul",{className:"indicator-list",children:t.itemIdx.map((i,b)=>e.jsxs("li",{children:[b+1,". ",y[i]]},i))})]}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"means-list",children:[e.jsx("div",{children:e.jsx("strong",{children:t.overall.toFixed(2)})}),t.itemIdx.map(i=>e.jsx("div",{children:x[i].toFixed(2)},i))]})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"means-list",children:[e.jsx("div",{children:e.jsx("strong",{children:l(t.overall)})}),t.itemIdx.map(i=>e.jsx("div",{children:l(x[i])},`lvl-${i}`))]})})]},h))})]})})(),e.jsx("div",{style:{height:16}}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("h3",{children:"List of Students and their Survey Responses"}),(()=>{const f=I(),g=L.map(n=>{const r=f[n.username]||{},u=Array.isArray(r.prePart2Responses)&&r.prePart2Responses.length===17?r.prePart2Responses:null;return{name:n.name||"",username:n.username||"",responses:u}}).filter(n=>n.responses!==null),x=n=>{const r=(n||"").trim().split(/\s+/);if(r.length<=1)return n;const u=r[r.length-1],p=r.slice(0,r.length-1).join(" ");return`${u}, ${p}`};return g.sort((n,r)=>x(n.name).toLowerCase().localeCompare(x(r.name).toLowerCase())),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),Array.from({length:17},(n,r)=>e.jsxs("th",{children:["Q",r+1]},r))]})}),e.jsx("tbody",{children:g.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{style:{whiteSpace:"nowrap",textAlign:"left"},children:x(n.name)}),n.responses.map((u,p)=>e.jsx("td",{children:u},p))]},n.username||r))})]})})})()]})]}),C==="post-assessment"&&e.jsxs("div",{className:"pre-assessment-layout",children:[e.jsxs("div",{className:"cards-row",children:[e.jsxs("div",{className:"stat-box metric-card card-enrolled",children:[e.jsx("h4",{children:"Students Enrolled"}),e.jsx("p",{className:"stat-number-large",children:D.length})]}),e.jsxs("div",{className:"stat-box metric-card card-takers",children:[e.jsx("h4",{children:"Actual Takers"}),e.jsx("p",{className:"stat-number-large",children:N.tested})]}),e.jsxs("div",{className:"stat-box metric-card donut-card card-completion",children:[e.jsx("h4",{children:"Completion Rate"}),e.jsx("div",{className:"donut-inline",children:(()=>{const f=D.length?Math.round(N.tested/D.length*100):0,g=32,x=2*Math.PI*g,n=f/100*x;return e.jsxs("svg",{viewBox:"0 0 100 100",className:"donut-svg",children:[e.jsx("circle",{cx:"50",cy:"50",r:g,stroke:"#e6eef9",strokeWidth:"14",fill:"none"}),e.jsx("circle",{cx:"50",cy:"50",r:g,stroke:"#6C8AE4",strokeWidth:"14",fill:"none",strokeDasharray:`${n} ${x-n}`,transform:"rotate(-90 50 50)"}),e.jsxs("text",{x:"50",y:"55",textAnchor:"middle",fill:"#3A4A7A",fontSize:"18",fontWeight:700,children:[f,"%"]})]})})()})]})]}),e.jsxs("div",{className:"charts-row one-column",children:[e.jsxs("div",{className:"chart-section wide card-levels",children:[e.jsx("h3",{children:"Students' Level of Achievement in Statistical Literacy and Critical Thinking (Post)"}),(()=>{const f=N.scores.filter(l=>l>=14).length,g=N.scores.filter(l=>l>=11&&l<=13).length,x=N.scores.filter(l=>l>=9&&l<=10).length,n=N.scores.filter(l=>l<=8).length,r=N.scores.length||1,u=[{label:`Beginning (${n})`,value:Math.round(n/r*100)},{label:`Developing (${x})`,value:Math.round(x/r*100)},{label:`Proficient (${g})`,value:Math.round(g/r*100)},{label:`Advanced (${f})`,value:Math.round(f/r*100)}],p=["#CBD5E1","#93B5E1","#6FA8DC","#4F6EDC"];return e.jsx(se,{data:u,type:"bar",colors:p})})()]}),e.jsxs("div",{className:"chart-section wide card-histogram",children:[e.jsx("h3",{children:"Frequency of Responses"}),(()=>{const f=I(),g=Array.from({length:15},()=>({A:0,B:0,C:0,D:0}));L.forEach(l=>{const y=f[l.username]||{},a=Array.isArray(y.postPart1Responses)&&y.postPart1Responses.length===15?y.postPart1Responses:null;a&&a.forEach((t,h)=>{const i=(t||"").toUpperCase();(i==="A"||i==="B"||i==="C"||i==="D")&&(g[h][i]=(g[h][i]||0)+1)})});const x=g.map(l=>l.A+l.B+l.C+l.D),n=Math.max(1,...x),r=["C","A","C","D","A","B","A","B","A","C","B","A","C","D","A"],u={A:"#FFF6C2",B:"#FFDDE6",C:"#E9D9FF",D:"#DFFFE1"},p="#7FA8FF";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",paddingLeft:40},children:[e.jsx("div",{style:{fontWeight:700},children:"Legend:"}),["A","B","C","D"].map(l=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:14,height:14,background:u[l],borderRadius:3,border:"1px solid #e6e6e6"}}),e.jsx("div",{style:{fontSize:13},children:l})]},l)),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:14,height:14,background:p,borderRadius:3,border:"1px solid #e6e6e6"}}),e.jsx("div",{style:{fontSize:13},children:"Correct"})]})]}),g.map((l,y)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("div",{style:{width:40,textAlign:"right",fontSize:12},children:["Q",y+1]}),e.jsx("div",{style:{flex:"1 1 auto",display:"flex",height:28,border:"1px solid #eef2ff",borderRadius:4,overflow:"hidden"},children:["A","B","C","D"].map(a=>{const t=l[a]||0,h=t/n*100,i=r[y]===a,b=i?p:u[a];return e.jsx("div",{style:{width:`${h}%`,background:b,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,color:i?"#fff":"#111"},children:t},a)})})]},y))]})})()]}),e.jsxs("div",{className:"chart-section wide card-boxplots",children:[e.jsx("h3",{children:"Boxplots by Learning Competency"}),(()=>{const f=N.groups,g=f.map(a=>a.lc12),x=f.map(a=>a.lc34),n=f.map(a=>a.lc56),r=a=>{if(a.length===0)return{min:0,q1:0,med:0,q3:0,max:0};const t=[...a].sort((i,b)=>i-b),h=i=>{const b=(t.length-1)*i,v=Math.floor(b),P=Math.ceil(b);return P===v?t[v]:t[v]+(t[P]-t[v])*(b-v)};return{min:t[0],q1:h(.25),med:h(.5),q3:h(.75),max:t[t.length-1]}},u=r(g),p=r(x),l=r(n),y=(a,t)=>{const h=i=>i/5*260;return e.jsxs("div",{className:"boxplot",children:[e.jsx("div",{className:"boxplot-label",children:t}),e.jsxs("svg",{viewBox:"0 0 300 60",className:"boxplot-svg",children:[e.jsx("line",{x1:20+h(a.min),y1:30,x2:20+h(a.max),y2:30,stroke:"#9fb7df",strokeWidth:2}),e.jsx("rect",{x:20+h(a.q1),y:18,width:Math.max(2,h(a.q3)-h(a.q1)),height:24,fill:"#f0f6ff",stroke:"#2C4795"}),e.jsx("line",{x1:20+h(a.med),y1:18,x2:20+h(a.med),y2:42,stroke:"#43A047",strokeWidth:2})]})]},t)};return e.jsxs("div",{className:"boxplots",children:[y(u,"LC1-2 (Items 1â€“5)"),y(p,"LC3-4 (Items 6â€“10)"),y(l,"LC5-6 (Items 11â€“15)")]})})()]}),e.jsxs("div",{className:"chart-section table-section card-student-responses",children:[e.jsx("h3",{children:"List of Students and their Responses"}),(()=>{const f=I(),g=L.map(n=>{const r=f[n.username]||{},u=Array.isArray(r.postPart1Responses)&&r.postPart1Responses.length===15?r.postPart1Responses:null,p=typeof r.postPart1Correct=="number"?r.postPart1Correct:null;return{name:n.name||"",username:n.username||"",responses:u,score:p}}).filter(n=>n.responses!==null),x=n=>{const r=(n||"").trim().split(/\s+/);if(r.length<=1)return n;const u=r[r.length-1],p=r.slice(0,r.length-1).join(" ");return`${u}, ${p}`};return g.sort((n,r)=>x(n.name).toLowerCase().localeCompare(x(r.name).toLowerCase())),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),Array.from({length:15},(n,r)=>e.jsxs("th",{children:["Q",r+1]},r)),e.jsx("th",{children:"Score"})]})}),e.jsx("tbody",{children:g.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{style:{whiteSpace:"nowrap",textAlign:"left"},children:x(n.name)}),n.responses.map((u,p)=>e.jsx("td",{children:u},p)),e.jsx("td",{style:{textAlign:"center"},children:n.score})]},n.username||r))})]})})})()]})]})]}),C==="end-survey"&&e.jsxs("div",{className:"initial-survey-layout",children:[(()=>{const f=O.responses,g=t=>t.length?t.reduce((h,i)=>h+i,0)/t.length:0,x=Array.from({length:17},(t,h)=>g(f.map(i=>i[h]).filter(i=>typeof i=="number"))),n=x.slice(0,5),r=x.slice(5,13),u=x.slice(13,17),p=t=>t.length?t.reduce((h,i)=>h+i,0)/t.length:0,l=t=>t>=3.26?"Very High":t>=2.51?"High":t>=1.76?"Low":"Very Low",y=["Climate change increases disease rates in my community.","Higher temperatures correlate with lower crop yields significantly.","Diarrhea cases rise when rainfall patterns change drastically.","Cholera becomes more toxic in warmer water temperatures.","Floods spread waterborne diseases faster than before now.","Public transportation reduces my personal carbon emissions significantly.","Eating natural foods lowers my environmental impact considerably.","GHG-free refrigerators decrease household emissions over time effectively.","Eco-friendly air conditioners use less energy than standard models.","Emission-free cars correlate with better local air quality.","Reducing trips decreases car fuel consumption and emissions.","Carpooling with others cuts per-person emissions by half.","Correct tire pressure improves fuel efficiency by percentages.","Proper building insulation reduces energy use significantly overall.","Solar energy adoption correlates with lower production costs.","Reusing waste heat decreases total energy consumption substantially.","Bio-gas use reduces industrial fossil fuel dependence considerably."],a=[{indicator:"Awareness of Effects or Impacts of Climate Change",itemIdx:[0,1,2,3,4],means:n,overall:p(n)},{indicator:"Awareness Individual Initiative to Address Climate Change",itemIdx:[5,6,7,8,9,10,11,12],means:r,overall:p(r)},{indicator:"Awareness of Industry Initiative to Address Climate Change",itemIdx:[13,14,15,16],means:u,overall:p(u)}];return e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left"},children:"Indicator & Statements"}),e.jsx("th",{style:{textAlign:"center"},children:"Scores"}),e.jsx("th",{style:{textAlign:"center"},children:"Description"})]})}),e.jsx("tbody",{children:a.map((t,h)=>e.jsxs("tr",{children:[e.jsxs("td",{style:{textAlign:"left"},children:[e.jsx("div",{className:"indicator-title",children:t.indicator}),e.jsx("ul",{className:"indicator-list",children:t.itemIdx.map((i,b)=>e.jsxs("li",{children:[b+1,". ",y[i]]},i))})]}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"means-list",children:[e.jsx("div",{children:e.jsx("strong",{children:t.overall.toFixed(2)})}),t.itemIdx.map(i=>e.jsx("div",{children:x[i].toFixed(2)},i))]})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"means-list",children:[e.jsx("div",{children:e.jsx("strong",{children:l(t.overall)})}),t.itemIdx.map(i=>e.jsx("div",{children:l(x[i])},`lvl-${i}`))]})})]},h))})]})})(),e.jsx("div",{style:{height:16}}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("h3",{children:"List of Students and their Survey Responses"}),(()=>{const f=I(),g=L.map(n=>{const r=f[n.username]||{},u=Array.isArray(r.postPart2Responses)&&r.postPart2Responses.length===17?r.postPart2Responses:null;return{name:n.name||"",username:n.username||"",responses:u}}).filter(n=>n.responses!==null),x=n=>{const r=(n||"").trim().split(/\s+/);if(r.length<=1)return n;const u=r[r.length-1],p=r.slice(0,r.length-1).join(" ");return`${u}, ${p}`};return g.sort((n,r)=>x(n.name).toLowerCase().localeCompare(x(r.name).toLowerCase())),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),Array.from({length:17},(n,r)=>e.jsxs("th",{children:["Q",r+1]},r))]})}),e.jsx("tbody",{children:g.map((n,r)=>e.jsxs("tr",{children:[e.jsx("td",{style:{whiteSpace:"nowrap",textAlign:"left"},children:x(n.name)}),n.responses.map((u,p)=>e.jsx("td",{children:u},p))]},n.username||r))})]})})})()]})]})]})]})]})};export{ue as A};
