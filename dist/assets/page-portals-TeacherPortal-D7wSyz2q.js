import{j as e,r as C}from"./vendor_react-DCpd0Dq0.js";import{a as K}from"./page-LandingPage.tsx-index-BSx3ZgHx.js";import{b as O,r as V}from"./page-auth-StudentLogin-Cey19Wqj.js";import{r as Y,u as Q}from"./vendor-DcDhwVwZ.js";import{P as X}from"./page-portals-PerformanceSummary-CcSN4ZIr.js";const W="studentClassMap",$=()=>{const l=localStorage.getItem(W);return l?JSON.parse(l):{}},_=l=>{localStorage.setItem(W,JSON.stringify(l))},F=(l,i)=>{const o=$();o[l]=i,_(o)},R=l=>{const i=$();delete i[l],_(i)},Z=(l,i)=>{const o=$();i.forEach(m=>{delete o[m]}),_(o)},z=({totalStudents:l,loggedInCount:i})=>{const o=l===0?0:Math.round(i/l*100),m=45,t=2*Math.PI*m,c=t-o/100*t;return e.jsxs("div",{className:"login-status-chart",children:[e.jsxs("div",{className:"donut-container",children:[e.jsxs("svg",{viewBox:"0 0 100 100",className:"donut-svg",children:[e.jsx("circle",{cx:"50",cy:"50",r:m,fill:"none",stroke:"#e0e0e0",strokeWidth:"12"}),e.jsx("circle",{cx:"50",cy:"50",r:m,fill:"none",stroke:"#0066cc",strokeWidth:"12",strokeDasharray:t,strokeDashoffset:c,strokeLinecap:"round",transform:"rotate(-90 50 50)",className:"donut-progress"})]}),e.jsxs("div",{className:"donut-center",children:[e.jsxs("div",{className:"percentage",children:[o,"%"]}),e.jsx("div",{className:"label",children:"Logged In"})]})]}),e.jsxs("div",{className:"chart-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-color logged-in"}),e.jsxs("span",{className:"legend-text",children:["Logged In: ",i]})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-color not-logged-in"}),e.jsxs("span",{className:"legend-text",children:["Not Logged In: ",l-i]})]})]})]})},I=({onCreateClass:l,classes:i,onDeleteClass:o,onUpdateStudents:m})=>{const[t,c]=C.useState(""),[j,w]=C.useState(""),[y,L]=C.useState({}),[a,u]=C.useState({}),N=s=>{s.preventDefault(),t&&j&&(l(t,j),c(""),w(""),alert("Class created successfully!"))},g=(s,n,r)=>{if(window.confirm(`Are you sure you want to delete ${n}? This will also delete all ${r.length} student(s) and their data.`)){const d=r.map(p=>p.username);Z(s,d),o(s),alert("Class and all associated student data deleted!")}},x=s=>{L(n=>({...n,[s]:!n[s]}))},b=(s,n)=>{u(r=>({...r,[s]:n}))},P=async(s,n)=>{try{const r=n.map(v=>v.trim()).filter(Boolean);if(r.length===0)return;const d=[];for(const v of r){const E=v.split(/\s+/).filter(Boolean),M=E[0]||"Student",S=E[E.length-1]||"User",J=String(Math.floor(Math.random()*1e3)).padStart(3,"0"),{username:T,password:B}=O(M,S,J),D=await V(v,T,B);if(D.success)d.push({id:Date.now().toString()+Math.random(),name:v,username:T,password:B,hasLoggedIn:!1}),F(T,s.id);else if(D.reason==="exists"){let q=!1,k=null;for(let U=0;U<10;U++){const H=String(Math.floor(Math.random()*9e4)+1e3),A=O(M,S,H),G=await V(v,A.username,A.password);if(G.success){q=!0,k=A;break}if(G.reason==="quota")throw new Error("localStorage_quota")}if(!q||!k)throw new Error("register_failed");d.push({id:Date.now().toString()+Math.random(),name:v,username:k.username,password:k.password,hasLoggedIn:!1}),F(k.username,s.id)}else throw D.reason==="quota"?new Error("localStorage_quota"):new Error("register_failed")}const p=[...s.students,...d];console.log("[ClassManagement] enrolling students",{classId:s.id,newStudents:d,updatedStudents:p}),m(s.id,p),alert(`Enrolled ${d.length} student(s) to Grade ${s.grade} - Section ${s.section}.`)}catch(r){console.error("Error enrolling students",r);try{r&&r.message==="localStorage_quota"?alert("Unable to enroll students: local storage quota exceeded. Please clear some data or use a different browser."):alert("Failed to enroll students. See console for details.")}catch{}}},h=async(s,n)=>{s.preventDefault();const d=(a[n.id]||"").split(/[\n,\t;]+/);await P(n,d),u(p=>({...p,[n.id]:""})),L(p=>({...p,[n.id]:!1}))},f=async(s,n)=>{try{if(s.name.toLowerCase().endsWith(".csv")){const d=(await s.text()).split(/[\n,\t;]+/);await P(n,d)}else{const r=await s.arrayBuffer(),d=Y(r,{type:"array"}),p=d.SheetNames[0],v=d.Sheets[p],M=Q.sheet_to_json(v,{header:1}).flat().map(S=>String(S)).filter(S=>S&&S.trim().length>0);await P(n,M)}L(r=>({...r,[n.id]:!1}))}catch(r){alert("Failed to parse the uploaded file. Please ensure it contains names in the first sheet or CSV rows."),console.error(r)}};return e.jsxs("div",{className:"class-management",children:[e.jsx("h2",{children:"Create New Class"}),e.jsx("form",{onSubmit:N,className:"class-form",children:e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"grade",children:"Grade Level"}),e.jsxs("select",{id:"grade",value:t,onChange:s=>c(s.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Grade Level"}),e.jsx("option",{value:"11",children:"Grade 11"}),e.jsx("option",{value:"12",children:"Grade 12"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"section",children:"Section Name"}),e.jsx("input",{id:"section",type:"text",placeholder:"Enter section name (e.g., A, B, C)",value:j,onChange:s=>w(s.target.value),required:!0})]}),e.jsx("div",{className:"submit-wrap",children:e.jsx("button",{type:"submit",className:"submit-button",children:"Create Class"})})]})}),e.jsxs("div",{className:"classes-summary",children:[e.jsx("h3",{children:"Classes Summary"}),i.length===0?e.jsx("p",{className:"no-classes",children:"No classes created yet."}):e.jsx("div",{className:"classes-grid",children:i.map(s=>e.jsxs("div",{className:"class-summary-card",children:[e.jsxs("div",{className:"class-header",children:[e.jsxs("h4",{children:["Grade ",s.grade," - Section ",s.section]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"batch-toggle",onClick:()=>x(s.id),title:"Add Student",children:"+ Add Student"}),e.jsx("button",{className:"delete-class-btn",onClick:()=>g(s.id,`Grade ${s.grade} - Section ${s.section}`,s.students),title:"Delete class",children:"ðŸ—‘ï¸"})]})]}),y[s.id]&&e.jsxs("div",{className:"batch-panel",children:[e.jsxs("div",{className:"batch-option",children:[e.jsx("h5",{children:"Encode List"}),e.jsxs("form",{onSubmit:n=>h(n,s),className:"batch-encode-form",children:[e.jsx("textarea",{className:"batch-textarea",placeholder:"Paste names separated by comma, tab, or newline",value:a[s.id]||"",onChange:n=>b(s.id,n.target.value),rows:4}),e.jsxs("div",{className:"panel-buttons",children:[e.jsx("button",{type:"submit",className:"save-btn",children:"Enroll"}),e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>x(s.id),children:"Cancel"})]})]})]}),e.jsxs("div",{className:"batch-option",children:[e.jsx("h5",{children:"Upload File"}),e.jsxs("div",{className:"batch-upload",children:[e.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:n=>{const r=n.target.files?.[0];r&&f(r,s)}}),e.jsx("p",{className:"hint",children:"Accepts Excel (.xlsx/.xls) or CSV; first sheet/column entries treated as names."})]})]})]}),e.jsxs("div",{className:"class-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Students Enrolled:"}),e.jsx("span",{className:"stat-value",children:s.students.length})]}),e.jsx("div",{className:"stat",children:e.jsx("span",{className:"stat-label",children:"Login Status:"})}),e.jsx(z,{totalStudents:s.students.length,loggedInCount:s.students.filter(n=>n.hasLoggedIn).length})]})]},s.id))})]})]})},ee=({classes:l,onUpdateStudents:i})=>{const[o,m]=C.useState("all"),t=o==="all"?void 0:l.find(a=>a.id===o),c=l.flatMap(a=>a.students),j=()=>{const a=[["Class Grade","Class Section","Student Name","Username","Password","Status"]];(t?t.students.map(h=>({s:h,c:t})):l.flatMap(h=>h.students.map(f=>({s:f,c:h})))).forEach(({s:h,c:f})=>{a.push([f.grade,f.section,h.name,h.username,h.password,h.hasLoggedIn?"Logged In":"Pending"])});const N=a.map(h=>h.map(f=>`"${String(f).replace(/"/g,'""')}"`).join(",")).join(`
`),g=new Blob([N],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(g),b=document.createElement("a");b.href=x;const P=t?`class_${t.grade}_${t.section}`:"all_classes";b.download=`${P}_students.csv`,b.click(),URL.revokeObjectURL(x)},w=t?t.students.length:c.length,y=t?t.students.filter(a=>a.hasLoggedIn).length:c.filter(a=>a.hasLoggedIn).length,L=a=>{if(t){const u=t.students.find(g=>g.id===a);u&&R(u.username);const N=t.students.filter(g=>g.id!==a);i(t.id,N)}else{const u=l.find(x=>x.students.some(b=>b.id===a));if(!u)return;const N=u.students.find(x=>x.id===a);N&&R(N.username);const g=u.students.filter(x=>x.id!==a);i(u.id,g)}};return e.jsxs("div",{className:"student-list-container",children:[e.jsx("h2",{children:"List of Classes"}),l.length===0?e.jsx("p",{className:"no-data",children:'No classes created yet. Go to "Create Class" to get started.'}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"class-selector",children:[e.jsx("label",{children:"Select Class:"}),e.jsxs("select",{value:o,onChange:a=>m(a.target.value),children:[e.jsx("option",{value:"all",children:"All Classes"}),l.map(a=>e.jsxs("option",{value:a.id,children:["Grade ",a.grade," - Section ",a.section]},a.id))]}),e.jsx("button",{className:"download-btn",onClick:j,children:"Download CSV"})]}),e.jsx("div",{className:"login-stats",children:e.jsxs("div",{className:"stat-card",children:[e.jsx("h3",{children:"Login Status"}),e.jsx(z,{totalStudents:w,loggedInCount:y})]})}),e.jsxs("table",{className:"students-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Student Name"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Password"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:(t?t.students:c).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"no-data",children:"No students enrolled yet."})}):(t?t.students:c).map(a=>e.jsxs("tr",{className:a.hasLoggedIn?"logged-in":"not-logged-in",children:[e.jsx("td",{children:a.name}),e.jsx("td",{className:"code",children:a.username}),e.jsx("td",{className:"code",children:a.password}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${a.hasLoggedIn?"active":"inactive"}`,children:a.hasLoggedIn?"âœ“ Logged In":"â³ Pending"})}),e.jsx("td",{children:e.jsx("button",{className:"delete-btn",onClick:()=>L(a.id),title:"Delete student",children:"ðŸ—‘ï¸"})})]},a.id))})]})]})]})},re=({onLogout:l,classes:i,onCreateClass:o,onUpdateStudents:m,onDeleteClass:t})=>{const[c,j]=C.useState("overview"),w=y=>{t&&t(y)};return e.jsxs("div",{className:"portal-container",children:[e.jsxs("header",{className:"portal-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("span",{className:"header-badge badge--teacher",children:e.jsx(K,{})}),e.jsxs("div",{className:"header-texts",children:[e.jsx("h1",{className:"portal-title",children:"Statistics Meets Climate Action"}),e.jsx("p",{className:"portal-subtitle",children:"Teacher Dashboard"})]})]}),e.jsxs("div",{className:"header-right",children:[e.jsxs("p",{className:"welcome-text",children:["Welcome, ",e.jsx("strong",{children:"Sir Christler"})]}),e.jsx("button",{className:"logout-button",onClick:l,children:"Logout"})]})]}),e.jsxs("main",{className:"portal-content",children:[e.jsxs("div",{className:"portal-tabs",children:[e.jsx("button",{className:`tab-button ${c==="overview"?"active":""}`,onClick:()=>j("overview"),children:"Overview"}),e.jsx("button",{className:`tab-button ${c==="create"?"active":""}`,onClick:()=>j("create"),children:"Create Class"}),e.jsx("button",{className:`tab-button ${c==="list"?"active":""}`,onClick:()=>j("list"),children:"List of Classes"}),e.jsx("button",{className:`tab-button ${c==="performance"?"active":""}`,onClick:()=>j("performance"),children:"Performance Summary"})]}),c==="overview"&&e.jsxs("section",{className:"overview",children:[e.jsxs("h2",{className:"overview-title",children:[e.jsx("span",{className:"title-top",children:"Digital Project-Based Learning:"}),e.jsx("span",{className:"title-bottom",children:"Integrating Climate Change into Statistics Instruction"})]}),e.jsx("p",{className:"overview-intro",children:"This material connects core statistics with real climate issues to build data literacy, critical thinking, and community-oriented problem solving. Students analyze local datasets, interpret relationships, and communicate insights for action. Activities emphasize meaningful applications of statistics to climate questions, helping learners understand evidence, uncertainty, and responsible decision-making."}),e.jsxs("div",{className:"overview-section",children:[e.jsxs("h3",{className:"center section-title",children:[e.jsx("span",{className:"title-icon",children:"ðŸ“˜"})," Learning Competencies"]}),e.jsx("p",{className:"overview-sub center",children:"These are the specific statistical skills students will develop through climate-focused projects."}),e.jsxs("div",{className:"cards-3",children:[e.jsx("div",{className:"card",children:e.jsxs("ul",{children:[e.jsxs("li",{children:["The learner calculates Pearson's sample correlation coefficient ",e.jsx("span",{className:"code-blue",children:"(M11/12SP-IVh-2)"})]}),e.jsxs("li",{children:["The learner solves problems involving correlation analysis ",e.jsx("span",{className:"code-blue",children:"(M11/12SP-IVh-3)"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("ul",{children:[e.jsxs("li",{children:["The learner calculates the slope and y-intercept of the regression line ",e.jsx("span",{className:"code-blue",children:"(M11/12SP-IVi-3)"})]}),e.jsxs("li",{children:["The learner interprets the calculated slope and y-intercept of the regression line ",e.jsx("span",{className:"code-blue",children:"(M11/12SP-IVi-4)"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("ul",{children:[e.jsxs("li",{children:["The learner predicts the value of the dependent variable given the value of the independent variable ",e.jsx("span",{className:"code-blue",children:"(M11/12SP-IVj-1)"})]}),e.jsxs("li",{children:["The learner solves problems involving regression analysis ",e.jsx("span",{className:"code-blue",children:"(M11/12SP-IVj-2)"})]})]})})]})]}),e.jsxs("div",{className:"overview-section",children:[e.jsxs("h3",{className:"center section-title",children:[e.jsx("span",{className:"title-icon",children:"ðŸŽ¯"})," Learning Objectives"]}),e.jsx("p",{className:"overview-sub center",children:"By the end of these projects, students will be able to apply statistical methods to real climate data."}),e.jsxs("div",{className:"cards-3",children:[e.jsx("div",{className:"card",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Explain the meaning, strength, and direction of Pearson's sample correlation by interpreting two local climate variables."}),e.jsx("li",{children:"Calculate Pearson's r accurately from a local environmental dataset using formulas or spreadsheets."}),e.jsx("li",{children:"Analyze a correlation scenario to propose at least one actionable recommendation for a local environmental problem."})]})}),e.jsx("div",{className:"card",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Explain the meaning of slope and yâ€‘intercept by describing how changes in one climate variable affect another."}),e.jsx("li",{children:"Calculate slope and yâ€‘intercept accurately from a local dataset using the correct formula or spreadsheet tools."}),e.jsx("li",{children:"Interpret slope and intercept to suggest practical recommendations addressing local environmental issues."})]})}),e.jsx("div",{className:"card",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Explain how a regression equation supports prediction by relating a climate input to an outcome."}),e.jsx("li",{children:"Predict the dependent variable accurately using a given regression equation and specified inputs."}),e.jsx("li",{children:"Analyze a regression problem, note limitations, and propose an actionable recommendation for the community."})]})})]})]}),e.jsxs("div",{className:"overview-section",children:[e.jsxs("h3",{className:"center section-title",children:[e.jsx("span",{className:"title-icon",children:"ðŸ§©"})," Expected Outputs"]}),e.jsx("p",{className:"overview-sub center",children:"Students will complete three progressive climate analysis projects demonstrating their statistical mastery."}),e.jsxs("div",{className:"cards-3 centered",children:[e.jsxs("div",{className:"card",children:[e.jsx("h4",{className:"blue-title",children:'Climate Correlation Analysis Project: "Understanding Our Local Environment"'}),e.jsx("p",{children:"Students investigate the relationship between two climate-related variables in the Davao Region and provide evidence-based recommendations to local stakeholders."}),e.jsx("span",{className:"duration",children:"Duration: 4 hours"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h4",{className:"blue-title",children:"Climate Action Project: Analyzing Local Environmental Trends Through Regression"}),e.jsx("p",{children:"Students analyze local data, calculate and interpret regression lines, and present actionable recommendations to relevant stakeholders."}),e.jsx("span",{className:"duration",children:"Duration: 4 hours"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h4",{className:"blue-title",children:'Climate-Impact Prediction Project: "What Will Our Weather Cost Us?"'}),e.jsx("p",{children:"Students model how a climate variable affects a community concern, use regression to make predictions, and propose recommendations to stakeholders."}),e.jsx("span",{className:"duration",children:"Duration: 4 hours"})]})]})]})]}),c==="create"&&e.jsx(I,{onCreateClass:o,classes:i,onDeleteClass:w,onUpdateStudents:m}),c==="list"&&e.jsx(ee,{classes:i,onUpdateStudents:m}),c==="performance"&&e.jsx(X,{classes:i})]})]})};export{re as T,Z as d};
